<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BDent License Generator - Admin Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="max-w-4xl mx-auto p-8">
        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">BDent License Generator</h1>
                    <p class="text-gray-600">Admin tool for generating license keys</p>
                </div>
                <div class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg font-medium">
                    Better Clinic Admin
                </div>
            </div>
        </div>

        <!-- Generator Form -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4">Generate New License</h2>
            
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Clinic Name</label>
                    <input type="text" id="clinicName" placeholder="Dr. Sharma's Dental Clinic" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Contact Email</label>
                    <input type="email" id="contactEmail" placeholder="clinic@example.com" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                    <input type="tel" id="phoneNumber" placeholder="+91 98765 43210" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Plan Type</label>
                    <select id="planType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="desktop">Desktop - â‚¹7,999 (Lifetime)</option>
                        <option value="desktop_cloud">Desktop + Cloud - â‚¹7,999 + â‚¹500/mo</option>
                        <option value="cloud">Cloud Only - â‚¹1,500/mo</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">AMC Duration</label>
                    <select id="amcDuration" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="1">1 Year - â‚¹3,000</option>
                        <option value="2">2 Years - â‚¹5,500</option>
                        <option value="3">3 Years - â‚¹7,500</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Payment Status</label>
                    <select id="paymentStatus" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="paid">Paid</option>
                        <option value="pending">Pending</option>
                        <option value="trial">Extended Trial</option>
                    </select>
                </div>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                <textarea id="notes" rows="2" placeholder="Any additional notes about this customer..." 
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
            </div>

            <button onclick="generateLicense()" 
                    class="w-full py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium">
                Generate License Key
            </button>
        </div>

        <!-- Generated License -->
        <div id="generatedLicense" class="bg-white rounded-2xl shadow-lg p-6 mb-6 hidden">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-800">Generated License</h2>
                <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium">New</span>
            </div>
            
            <div class="bg-gray-50 rounded-xl p-6 mb-4">
                <div class="text-center">
                    <p class="text-sm text-gray-500 mb-2">License Key</p>
                    <p id="licenseKey" class="text-3xl font-mono font-bold text-indigo-600 tracking-wider"></p>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-4 text-sm">
                <div>
                    <span class="text-gray-500">Clinic:</span>
                    <span id="displayClinic" class="ml-2 font-medium text-gray-800"></span>
                </div>
                <div>
                    <span class="text-gray-500">Plan:</span>
                    <span id="displayPlan" class="ml-2 font-medium text-gray-800"></span>
                </div>
                <div>
                    <span class="text-gray-500">Generated:</span>
                    <span id="displayDate" class="ml-2 font-medium text-gray-800"></span>
                </div>
                <div>
                    <span class="text-gray-500">AMC Expires:</span>
                    <span id="displayAmc" class="ml-2 font-medium text-gray-800"></span>
                </div>
            </div>

            <div class="flex gap-3">
                <button onclick="copyLicense()" 
                        class="flex-1 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                    ðŸ“‹ Copy Key
                </button>
                <button onclick="copyWhatsAppMessage()" 
                        class="flex-1 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors font-medium">
                    ðŸ“± Copy WhatsApp Message
                </button>
                <button onclick="saveLicense()" 
                        class="flex-1 py-2 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-colors font-medium">
                    ðŸ’¾ Save to History
                </button>
            </div>
        </div>

        <!-- License History -->
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-800">License History</h2>
                <button onclick="exportHistory()" class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">
                    Export CSV
                </button>
            </div>
            
            <div id="licenseHistory" class="space-y-3">
                <p class="text-gray-500 text-center py-8">No licenses generated yet</p>
            </div>
        </div>
    </div>

    <script>
        let currentLicense = null;
        let licenseHistory = JSON.parse(localStorage.getItem('bdent_license_history') || '[]');

        function generateRandomString(length) {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateLicenseKey() {
            return `BDENT-${generateRandomString(4)}-${generateRandomString(4)}-${generateRandomString(4)}`;
        }

        function generateLicense() {
            const clinicName = document.getElementById('clinicName').value.trim();
            const contactEmail = document.getElementById('contactEmail').value.trim();
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            const planType = document.getElementById('planType').value;
            const amcDuration = parseInt(document.getElementById('amcDuration').value);
            const paymentStatus = document.getElementById('paymentStatus').value;
            const notes = document.getElementById('notes').value.trim();

            if (!clinicName) {
                alert('Please enter clinic name');
                return;
            }

            const licenseKey = generateLicenseKey();
            const now = new Date();
            const amcExpiry = new Date(now);
            amcExpiry.setFullYear(amcExpiry.getFullYear() + amcDuration);

            const planNames = {
                'desktop': 'Desktop (Lifetime)',
                'desktop_cloud': 'Desktop + Cloud',
                'cloud': 'Cloud Only'
            };

            currentLicense = {
                key: licenseKey,
                clinicName,
                contactEmail,
                phoneNumber,
                plan: planType,
                planName: planNames[planType],
                amcDuration,
                amcExpiry: amcExpiry.toISOString(),
                paymentStatus,
                notes,
                generatedAt: now.toISOString()
            };

            // Display
            document.getElementById('licenseKey').textContent = licenseKey;
            document.getElementById('displayClinic').textContent = clinicName;
            document.getElementById('displayPlan').textContent = planNames[planType];
            document.getElementById('displayDate').textContent = now.toLocaleDateString('en-IN');
            document.getElementById('displayAmc').textContent = amcExpiry.toLocaleDateString('en-IN');
            document.getElementById('generatedLicense').classList.remove('hidden');
        }

        function copyLicense() {
            if (currentLicense) {
                navigator.clipboard.writeText(currentLicense.key);
                alert('License key copied!');
            }
        }

        function copyWhatsAppMessage() {
            if (currentLicense) {
                const message = `ðŸ¦· *BDent License Activation*

Hello! Thank you for purchasing BDent.

*Your License Details:*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ License Key: \`${currentLicense.key}\`
ðŸ¥ Clinic: ${currentLicense.clinicName}
ðŸ“¦ Plan: ${currentLicense.planName}
ðŸ“… AMC Valid Until: ${new Date(currentLicense.amcExpiry).toLocaleDateString('en-IN')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

*How to Activate:*
1. Open BDent app
2. Click "Activate License"
3. Enter your clinic name
4. Enter the license key above

Need help? Reply to this message or call us.

Thank you for choosing BDent! ðŸ™
_Better Clinic_`;

                navigator.clipboard.writeText(message);
                alert('WhatsApp message copied!');
            }
        }

        function saveLicense() {
            if (currentLicense) {
                licenseHistory.unshift(currentLicense);
                localStorage.setItem('bdent_license_history', JSON.stringify(licenseHistory));
                renderHistory();
                alert('License saved to history!');
            }
        }

        function renderHistory() {
            const container = document.getElementById('licenseHistory');
            
            if (licenseHistory.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">No licenses generated yet</p>';
                return;
            }

            container.innerHTML = licenseHistory.map((license, index) => `
                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-mono text-indigo-600 font-medium">${license.key}</span>
                        <span class="text-xs text-gray-500">${new Date(license.generatedAt).toLocaleDateString('en-IN')}</span>
                    </div>
                    <div class="flex items-center justify-between text-sm">
                        <span class="text-gray-800">${license.clinicName}</span>
                        <span class="text-gray-500">${license.planName}</span>
                    </div>
                    ${license.phoneNumber ? `<div class="text-xs text-gray-500 mt-1">${license.phoneNumber}</div>` : ''}
                </div>
            `).join('');
        }

        function exportHistory() {
            if (licenseHistory.length === 0) {
                alert('No licenses to export');
                return;
            }

            const headers = ['License Key', 'Clinic Name', 'Email', 'Phone', 'Plan', 'AMC Expiry', 'Payment Status', 'Generated Date', 'Notes'];
            const rows = licenseHistory.map(l => [
                l.key,
                l.clinicName,
                l.contactEmail,
                l.phoneNumber,
                l.planName,
                new Date(l.amcExpiry).toLocaleDateString('en-IN'),
                l.paymentStatus,
                new Date(l.generatedAt).toLocaleDateString('en-IN'),
                l.notes
            ]);

            const csv = [headers, ...rows].map(row => row.map(cell => `"${cell || ''}"`).join(',')).join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bdent-licenses-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
        }

        // Initial render
        renderHistory();
    </script>
</body>
</html>
